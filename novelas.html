<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>JC TV STREAMING</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
<style>
html, body {
  overflow-y: auto; /* ‚úÖ Permite rolagem vertical */
  height: 100%;
  margin: 0;
  padding: 0;
}
#seriesTabs { display: flex; flex-wrap: wrap; justify-content: center; gap: 1rem; padding: 1rem 0; margin-top: 120px; }
.series-tab { display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem 1rem; background-color: #eee; border-radius: 0.5rem; max-width: 100%; white-space: normal; cursor: pointer; }
.series-tab img { width: 100%; height: 100%; border-radius: 5px; flex-shrink: 0; }
.series-tab .card { width: 100px; }
.card-body p.card-text { white-space: normal !important; word-break: break-word; overflow-wrap: break-word; font-size: 0.75rem; text-align: center; max-height: 6em; line-height: 1.2; }
#serieInfo { display: none; padding: 1rem; background: rgba(255, 255, 255, 0.25); border-radius: 12px; margin: 1rem auto; max-width: 1200px; backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); color: #000; }
.serie-details { display: flex; gap: 1rem; align-items: flex-start; }
.serie-details img { width: 100px; height: auto; border-radius: 5px; }
.serie-details div { flex: 1; }
#serieInfo h4, #serieInfo p { color: #000; font-weight: 600; }
#backButton { display: none; position: fixed; top: 2px; right: 0px; z-index: 1055; background-color: #FFC107; color: #000; border: none; padding: 8px 10px; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 12px; transition: 0.3s ease; }
#backButton:hover { background-color: #007BFF; color: #fff; }
footer.footer { position: fixed; bottom: 0; left: 0; width: 100%; background: black; color: #fff; display: flex; justify-content: center; align-items: center; gap: 10px; padding: 10px 20px; font-size: 1rem; z-index: 1000; }
footer.footer img { height: 30px; width: auto; }
#centralSearch { position: fixed; top: 30px; left: 50%; transform: translateX(-50%); width: 200px; z-index: 1050; display: flex; flex-direction: column; gap: 8px; margin-bottom: 10px; }
#serieSynopsis .synopsis-text { display: block; overflow: hidden; max-height: 3.6em; transition: max-height 0.3s ease; }
#serieSynopsis .expanded { max-height: 1000px; }
.modal-fullscreen { overflow: hidden; }
.modal-body { overflow: hidden; display: flex; justify-content: center; align-items: center; }
#modalVideo { object-fit: contain; width: 100%; height: 100%; }
.modal-header-transparent { background: rgba(0, 0, 0, 0.4); position: absolute; top: 0; left: 0; width: 100%; z-index: 10; display: flex; justify-content: space-between; align-items: center; padding: 0.5rem 1rem; transition: opacity 0.3s ease; }
#prevEpisodeBtn, #nextEpisodeBtn, #castButton { background-color: rgba(0, 0, 0, 0.6); color: #fff; border: 1px solid rgba(255,255,255,0.3); }
#prevEpisodeBtn:hover, #nextEpisodeBtn:hover, #castButton:hover { background-color: rgba(255,255,255,0.2); color: #fff; }
#readMoreBtn { display: inline-block; margin-top: 4px; cursor: pointer; color: #007BFF; font-weight: bold; background: none; border: none; padding: 0; }
@media (max-width: 576px) { .serie-details { flex-direction: column; align-items: center; text-align: center; } .serie-details img { width: 80%; max-width: 150px; } #seasonEpisodesContainer .accordion-button { font-size: 0.9rem; } .series-tab .card { width: 70px; } .series-tab .card-body p.card-text { font-size: 0.65rem; } #modalVideo { height: 60vh; } }
#modalTitle {
  font-size: 0.95rem; /* tamanho menor */
  font-weight: 600; /* opcional: mant√©m legibilidade */
  line-height: 1.4;
  text-align:  left; /* deixa bonito no lado esquerdo */
}
.list-group-item {
  transition: all 0.3s ease;
  cursor: pointer;
}

/* efeito ao passar o mouse */
.list-group-item:hover {
  background-color: rgba(0, 123, 255, 0.2);
  transform: scale(1.02);
}

/* efeito para toque em celular (remov√≠vel automaticamente ap√≥s o toque) */
.list-group-item.touch-hover {
  background-color: rgba(0, 123, 255, 0.2);
  transform: scale(1.02);
}
</style>
</head>
<body>
<button id="backButton" class="btn btn-primary btn-lg">Voltar</button>

<div id="centralSearch">
  <input type="search" id="seriesSearch" class="form-control" placeholder="Pesquisar...">
  <select id="categoryFilter" class="form-select">
    <option value="">Todas as Categorias</option>
  </select>
</div>

<ul class="nav nav-tabs d-flex flex-wrap gap-3 mb-3 border-0" id="seriesTabs"></ul>

<div id="serieInfo" class="card p-3">
  <div class="serie-details">
    <img id="seriePoster" src="" alt="Poster da S√©rie">
    <div>
      <h4 id="serieTitle"></h4>
      <p id="serieSynopsis" class="mb-0"></p>
      <p><strong>Categoria:</strong> <span id="serieCategories"></span></p>
      <p><strong>G√™nero:</strong> <span id="serieG√™nero"></span></p>
      <p><strong>Linguagem:</strong> <span id="serieLanguage"></span></p>
    </div>
  </div>
  <div id="seasonEpisodesContainer" class="mt-4"></div>
</div>

<div class="modal fade" id="playerModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-fullscreen">
    <div class="modal-content bg-black text-white">
      <div class="modal-header border-0 modal-header-transparent">
        <h5 id="modalTitle" class="modal-title"></h5>
        <div>
          <button id="prevEpisodeBtn" class="btn btn-sm me-2">‚èÆÔ∏è </button>
          <button id="nextEpisodeBtn" class="btn btn-sm me-2">‚è≠Ô∏è </button>
          <button id="castButton" class="btn btn-sm me-2">üì∫ </button>
          <button type="button" class="btn btn-sm btn-danger me-2" data-bs-dismiss="modal"> X </button>
        </div>
      </div>

      <div class="modal-body p-0">
        <video id="modalVideo" width="100%" height="100%" controls autoplay style="background:black;"></video>
      </div>
    </div>
  </div>
</div>

<footer class="footer">
  <img src="https://www.mediafire.com/convkey/7a81/hl79s61t5v9c0555g.jpg" alt="Logo" />
  <span>JC TV STREAMING ¬© 2025</span>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<script>
// -------------------- Dados da s√©rie --------------------
const seriesData = {
    "Robin Hood (2025)": {
    name: "Robin Hood (2025)",
    date: "02/11/2025",
    synopsis: "A jornada de Robert Locksley, de filho de guarda-florestal a fora-da-lei, come√ßa. A rebeli√£o come√ßa em Sherwood, intrigas aumentam, e nasce uma lenda.",
    poster: "https://image.tmdb.org/t/p/w500/aTBRFl6l1qPW34nuZ1FC3zRgfPE.jpg",
    background: "https://image.tmdb.org/t/p/original/uoIOfRNmu47P2fET2KnrYHt3TH.jpg",
    categories: ["Letra R"],
    genero: ["Drama","A√ß√£o e Aventura"],
    language: ["Dublado"],
    seasons: {
       1: [
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/03/272418/1/dub/1.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/03/272418/1/dub/2.mp4" }]
    }
    },
    "A Crise dos Caras (2025)": {
    name: "A Crise dos Caras (2025)",
    date: "02/11/2025",
    synopsis: "Quatro amigos quarent√µes fazem o que podem para encarar a masculinidade moderna, mas acabam metendo os p√©s pelas m√£os.",
    poster: "https://image.tmdb.org/t/p/w500/hOq7UDe4W9g3K3NFHDCvzJVPih8.jpg",
    background: "https://image.tmdb.org/t/p/original/l1fYY1YpDHL0GsC5pz0IP9E6ivC.jpg",
    categories: ["Letra A"],
    genero: ["Com√©dia"],
    language: ["Dublado"],
    seasons: {
       1: [
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/03/298699/1/dub/1.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/03/298699/1/dub/2.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/03/298699/1/dub/3.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/03/298699/1/dub/4.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/03/298699/1/dub/5.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/03/298699/1/dub/6.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/03/298699/1/dub/7.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/03/298699/1/dub/8.mp4" }]
    }
    },
    "Pesadelos da Natureza (2025)": {
    name: "Pesadelos da Natureza (2025)",
    date: "30/07/2025",
    synopsis: "Com hist√≥rias eletrizantes de sobreviv√™ncia, esta s√©rie documental captura todo o drama, o perigo e a beleza sombria da natureza pela perspectiva das presas.",
    poster: "https://image.tmdb.org/t/p/w500/gXsUclx4vqMBFrkGzabiCzXN0MY.jpg",
    background: "https://image.tmdb.org/t/p/original/sXLwuwDOAxklnnQFfa7OHCPgHDL.jpg",
    categories: ["Letra P"],
    genero: ["Document√°rio"],
    language: ["Dublado"],
    seasons: {
       1: [
        { title: "Fugindo da Floresta", url: "https://plustv.jctvstreaming-vip.workers.dev/03/298682/1/dub/1.mp4" },
        { title: "A Cabana", url: "https://plustv.jctvstreaming-vip.workers.dev/03/298682/1/dub/2.mp4" },
        { title: "√â Hora de Sair Daqui", url: "https://plustv.jctvstreaming-vip.workers.dev/03/298682/1/dub/3.mp4" }],
      2: [
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/03/298682/2/dub/1.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/03/298682/2/dub/2.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/03/298682/2/dub/3.mp4" }]
    }
    },
    "The Witcher (2019)": {
    name: "The Witcher (2019)",
    date: "20/12/2019",
    synopsis: "O mutante Geralt de R√≠via √© um ca√ßador de monstros que luta para encontrar seu lugar num mundo onde as pessoas muitas vezes s√£o mais perversas que as criaturas selvagens.",
    poster: "https://image.tmdb.org/t/p/w500/uJ1kQWTY1nElMcrrbHtDitbV85K.jpg",
    background: "https://image.tmdb.org/t/p/original/stqplzRvsPnFWPv5CCGaH7NohN0.jpg",
    categories: ["Letra T"],
    genero: ["Fic√ß√£o Cient√≠fica e Fantasia","Drama","A√ß√£o e Aventura"],
    language: ["Dublado"],
    seasons: {
       1: [
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/1/1.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/1/2.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/1/3.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/1/4.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/1/5.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/1/6.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/1/7.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/1/8.mp4" }],
      2: [
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/2/dub/1.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/2/dub/2.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/2/dub/3.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/2/dub/4.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/2/dub/5.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/2/dub/6.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/2/dub/7.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/2/dub/8.mp4" }],
      3: [
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/3/1.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/3/2.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/3/3.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/3/4.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/3/5.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/3/6.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/3/7.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/3/8.mp4" }],
      4: [
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/4/dub/1.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/4/dub/2.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/4/dub/3.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/4/dub/4.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/4/dub/5.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/4/dub/6.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/4/dub/7.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/71912/4/dub/8.mp4" }]
    }
    },
    "9-1-1: Nashville (2025)": {
    name: "9-1-1: Nashville (2025)",
    date: "09/10/2025",
    synopsis: "Bobby e sua equipe atendem uma emerg√™ncia em uma festa de anivers√°rio. A equipe entra em a√ß√£o, depois que um de seus membros se envolve em um acidente.",
    poster: "https://image.tmdb.org/t/p/w500/4Dl0LysUOEWOhitzAfrKFkBeefu.jpg",
    background: "https://image.tmdb.org/t/p/original/eO4cbYrbYIwn6uFZgpvdfD9eY9o.jpg",
    categories: ["N√∫meros e S√≠mbolos"],
    genero: ["Drama","A√ß√£o e Aventura"],
    language: ["Legendado"],
    seasons: {
       1: [
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/284838/1/leg/1.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/284838/1/leg/2.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/284838/1/leg/3.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/284838/1/leg/4.mp4" },
        { title: "", url: "https://plustv.jctvstreaming-vip.workers.dev/02/284838/1/leg/5.mp4" }]
    }
    },
    "": {
    name: "",
    date: "01/01/2050",
    synopsis: "",
    poster: "",
    background: "",
    categories: ["Letra S"],
    genero: [""],
    language: ["Dublado"],
    seasons: {
       1: [
        { title: "", url: "" },
        { title: "", url: "" }],
      2: [
        { title: "", url: "" },
        { title: "", url: "" }]
    }
    },
    "": {
    name: "",
    date: "01/01/2050",
    synopsis: "",
    poster: "",
    background: "",
    categories: ["Letra S"],
    genero: [""],
    language: ["Dublado"],
    seasons: {
       1: [
        { title: "", url: "" },
        { title: "", url: "" }],
      2: [
        { title: "", url: "" },
        { title: "", url: "" }]
    }
    },
    "": {
    name: "",
    date: "01/01/2050",
    synopsis: "",
    poster: "",
    background: "",
    categories: ["Letra S"],
    genero: [""],
    language: ["Dublado"],
    seasons: {
       1: [
        { title: "", url: "" },
        { title: "", url: "" }],
      2: [
        { title: "", url: "" },
        { title: "", url: "" }]
    }
    },
    "": {
    name: "",
    date: "01/01/2050",
    synopsis: "",
    poster: "",
    background: "",
    categories: ["Letra S"],
    genero: [""],
    language: ["Dublado"],
    seasons: {
       1: [
        { title: "", url: "" },
        { title: "", url: "" }],
      2: [
        { title: "", url: "" },
        { title: "", url: "" }]
    }
    },
    "": {
    name: "",
    date: "01/01/2050",
    synopsis: "",
    poster: "",
    background: "",
    categories: ["Letra S"],
    genero: [""],
    language: ["Dublado"],
    seasons: {
       1: [
        { title: "", url: "" },
        { title: "", url: "" }],
      2: [
        { title: "", url: "" },
        { title: "", url: "" }]
    }
    },
    "": {
    name: "",
    date: "01/01/2050",
    synopsis: "",
    poster: "",
    background: "",
    categories: ["Letra S"],
    genero: [""],
    language: ["Dublado"],
    seasons: {
       1: [
        { title: "", url: "" },
        { title: "", url: "" }],
      2: [
        { title: "", url: "" },
        { title: "", url: "" }]
    }
    },
    "": {
    name: "",
    date: "01/01/2050",
    synopsis: "",
    poster: "",
    background: "",
    categories: ["Letra S"],
    genero: [""],
    language: ["Dublado"],
    seasons: {
       1: [
        { title: "", url: "" },
        { title: "", url: "" }],
      2: [
        { title: "", url: "" },
        { title: "", url: "" }]
    }
    },
    "": {
    name: "",
    date: "01/01/2050",
    synopsis: "",
    poster: "",
    background: "",
    categories: ["Letra S"],
    genero: [""],
    language: ["Dublado"],
    seasons: {
       1: [
        { title: "", url: "" },
        { title: "", url: "" }],
      2: [
        { title: "", url: "" },
        { title: "", url: "" }]
    }
    },
    "": {
    name: "",
    date: "01/01/2050",
    synopsis: "",
    poster: "",
    background: "",
    categories: ["Letra S"],
    genero: [""],
    language: ["Dublado"],
    seasons: {
       1: [
        { title: "", url: "" },
        { title: "", url: "" }],
      2: [
        { title: "", url: "" },
        { title: "", url: "" }]
    }
    },
    "": {
    name: "",
    date: "01/01/2050",
    synopsis: "",
    poster: "",
    background: "",
    categories: ["Letra S"],
    genero: [""],
    language: ["Dublado"],
    seasons: {
       1: [
        { title: "", url: "" },
        { title: "", url: "" }],
      2: [
        { title: "", url: "" },
        { title: "", url: "" }]
    }
    },
    "": {
    name: "",
    date: "01/01/2050",
    synopsis: "",
    poster: "",
    background: "",
    categories: ["Letra S"],
    genero: [""],
    language: ["Dublado"],
    seasons: {
       1: [
        { title: "", url: "" },
        { title: "", url: "" }],
      2: [
        { title: "", url: "" },
        { title: "", url: "" }]
    }
    },
    "": {
    name: "",
    date: "01/01/2050",
    synopsis: "",
    poster: "",
    background: "",
    categories: ["Letra S"],
    genero: [""],
    language: ["Dublado"],
    seasons: {
       1: [
        { title: "", url: "" },
        { title: "", url: "" }],
      2: [
        { title: "", url: "" },
        { title: "", url: "" }]
    
    






    }
    }  
   };



// ---------------- Elementos
const seriesTabs = document.getElementById("seriesTabs");
const serieInfo = document.getElementById("serieInfo");
const serieTitle = document.getElementById("serieTitle");
const serieSynopsis = document.getElementById("serieSynopsis");
const seriePoster = document.getElementById("seriePoster");
const serieCategories = document.getElementById("serieCategories");
const serieG√™nero = document.getElementById("serieG√™nero");
const serieLanguage = document.getElementById("serieLanguage");
const seasonEpisodesContainer = document.getElementById("seasonEpisodesContainer");
const seriesSearch = document.getElementById("seriesSearch");
const categoryFilter = document.getElementById("categoryFilter");
const backButton = document.getElementById('backButton');
const modalVideo = document.getElementById("modalVideo");
const modalTitle = document.getElementById("modalTitle");
const prevEpisodeBtn = document.getElementById("prevEpisodeBtn");
const nextEpisodeBtn = document.getElementById("nextEpisodeBtn");
const castButton = document.getElementById("castButton");

let currentSeries = null;
let episodeQueue = [];
let currentEpisodeIndex = 0;
let currentHls = null;

// ---------------- Categorias
function populateCategories(){
  const allCategories = new Set();
  Object.values(seriesData).forEach(s => s.categories.forEach(c => allCategories.add(c)));
  [...allCategories].sort().forEach(cat=>{
    const option = document.createElement("option");
    option.value = cat; option.textContent = cat;
    categoryFilter.appendChild(option);
  });
}

// ---------------- Monta abas (ordenando por date)
function buildTabs(filteredKeys = null) {
  seriesTabs.innerHTML = "";
  let keys = filteredKeys || Object.keys(seriesData);

  // Ordena por data (mais recente primeiro)
  keys.sort((a, b) => {
    const dateA = seriesData[a].date
      ? new Date(seriesData[a].date.split("/").reverse().join("-"))
      : new Date(0);
    const dateB = seriesData[b].date
      ? new Date(seriesData[b].date.split("/").reverse().join("-"))
      : new Date(0);
    return dateB - dateA;
  });

  keys.forEach(key => {
    const s = seriesData[key];
    const li = document.createElement("li");
    li.className = "nav-item";

    const btn = document.createElement("button");
    btn.className = "nav-link p-0 border-0 bg-transparent text-center series-tab";
    btn.dataset.target = key;

    btn.innerHTML = `
      <div class="card border-0" style="width: 80px;">
        <img src="${s.poster}" class="card-img-top rounded" style="height:120px;object-fit:cover;" alt="${s.name}">
        <div class="card-body p-1">
          <p class="card-text small text-truncate mb-0">${s.name}</p>
        </div>
      </div>
    `;

    li.appendChild(btn);
    seriesTabs.appendChild(li);
  });
}

// -------------------- Mostra detalhes da s√©rie --------------------
function showSeasons(key, tabBtn) {
  const s = seriesData[key];
  serieTitle.textContent = s.name;
  seriePoster.src = s.poster;
  serieCategories.textContent = s.categories.join(", ");
  serieG√™nero.textContent = s.genero.join(", ");
  serieLanguage.textContent = s.language.join(", ");
  serieInfo.style.display = "block";

  // Sinopse com "ler mais/ler menos"
  serieSynopsis.innerHTML = "";
  const synopsisText = document.createElement("span");
  synopsisText.className = "synopsis-text";
  synopsisText.style.whiteSpace = "pre-wrap";
  synopsisText.style.display = "inline";

  const fullText = s.synopsis.trim();
  const shortText = fullText.length > 100 ? fullText.slice(0, 100) + "..." : fullText;
  let expanded = false;

  synopsisText.textContent = shortText;
  serieSynopsis.appendChild(synopsisText);

  if (fullText.length > 50) {
    const lerMaisBtn = document.createElement("span");
    lerMaisBtn.textContent = " ler mais";
    lerMaisBtn.style.color = "#007bff";
    lerMaisBtn.style.cursor = "pointer";
    lerMaisBtn.style.textDecoration = "underline";
    lerMaisBtn.style.marginLeft = "5px";

    serieSynopsis.appendChild(lerMaisBtn);

    lerMaisBtn.addEventListener("click", () => {
      expanded = !expanded;
      if (expanded) { synopsisText.textContent = fullText; lerMaisBtn.textContent = " ler menos"; }
      else { synopsisText.textContent = shortText; lerMaisBtn.textContent = " ler mais"; }
    });
  }

  // Posiciona info logo abaixo da aba selecionada
  const li = tabBtn.closest("li");
  li.insertAdjacentElement("afterend", serieInfo);

  // ---------------- Epis√≥dios ----------------
  seasonEpisodesContainer.innerHTML = "";
let seasonId = 0;

for (const [seasonNum, episodes] of Object.entries(s.seasons)) {
  seasonId++;
  const container = document.createElement("div");
  container.className = "accordion mb-2";
  container.id = `accordionSeason${seasonId}`;
  const item = document.createElement("div");
  item.className = "accordion-item";
  const headerId = `heading${seasonId}`;
  const collapseId = `collapse${seasonId}`;

  item.innerHTML = `
    <h2 class="accordion-header" id="${headerId}">
      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
        data-bs-target="#${collapseId}" aria-expanded="false" aria-controls="${collapseId}">
        Temporada ${seasonNum}
      </button>
    </h2>
    <div id="${collapseId}" class="accordion-collapse collapse" aria-labelledby="${headerId}"
         data-bs-parent="#accordionSeason${seasonId}">
      <ul class="list-group list-group-flush">
        ${episodes
          .map((ep, idx) => {
            const epTitle = ep.title ? ` ‚Äì ${ep.title}` : "";
            return `<li class="list-group-item open-player"
              data-vid="${ep.url}"
              data-title="${s.name} ‚Äì Temporada ${seasonNum} ‚Äì Epis√≥dio ${idx + 1}${epTitle}">
              Epis√≥dio ${idx + 1}${epTitle}
            </li>`;
          })
          .join("")}
      </ul>
    </div>
  `;
  container.appendChild(item);
  seasonEpisodesContainer.appendChild(container);
}

  // ---------------- Background ----------------
  document.body.style.backgroundImage = `url('${s.background}')`;
  document.body.style.backgroundSize = "cover";
  document.body.style.backgroundPosition = "center";
  document.body.style.backgroundRepeat = "no-repeat";
  document.body.style.backgroundAttachment = "fixed";
}

// ---------------- Toggle UI
function updateUIOnTabToggle(){
  if(currentSeries){ 
    backButton.style.display='block'; 
    seriesSearch.style.display='none'; 
    categoryFilter.style.display='none'; 
    document.querySelectorAll('#seriesTabs > li').forEach(li=>li.style.display='none'); 
  }
  else { 
    backButton.style.display='none'; 
    seriesSearch.style.display='block'; 
    categoryFilter.style.display='block'; 
    document.querySelectorAll('#seriesTabs > li').forEach(li=>li.style.display='inline-block'); 
  }
}

document.addEventListener("click", (e) => {
  const epItem = e.target.closest(".open-player");
  if (!epItem) return;

  // efeito toque
  epItem.classList.add("touch-hover");
  setTimeout(() => {
    epItem.classList.remove("touch-hover");
  }, 300); // dura√ß√£o igual √† transi√ß√£o CSS

  // carregar epis√≥dio normalmente
  const seasonContainer = epItem.closest(".accordion-collapse");
  const seasonEps = Array.from(seasonContainer.querySelectorAll(".open-player"));
  episodeQueue = seasonEps.map(b => ({ src: b.dataset.vid, title: b.dataset.title }));
  currentEpisodeIndex = seasonEps.indexOf(epItem);
  playEpisode(currentEpisodeIndex);
});

document.addEventListener("click", (e)=>{
  const epItem = e.target.closest(".open-player");
  if(!epItem) return;

  // Remover destaque anterior
  document.querySelectorAll(".open-player.active-episode").forEach(el=>el.classList.remove("active-episode"));
  epItem.classList.add("active-episode");

  // Para efeito de toque em celular
  document.querySelectorAll(".open-player.touch-hover").forEach(el=>el.classList.remove("touch-hover"));
  epItem.classList.add("touch-hover");

  epItem.scrollIntoView({behavior:"smooth", block:"center"});

  // Carregar epis√≥dios
  const seasonContainer = epItem.closest(".accordion-collapse");
  const seasonEps = Array.from(seasonContainer.querySelectorAll(".open-player"));
  episodeQueue = seasonEps.map(b => ({src:b.dataset.vid, title:b.dataset.title}));
  currentEpisodeIndex = seasonEps.indexOf(epItem);
  playEpisode(currentEpisodeIndex);
});

// ---------------- Eventos
seriesTabs.addEventListener("click",(e)=>{
  const btn = e.target.closest("button.series-tab"); if(!btn) return;
  const target = btn.dataset.target;
  if(currentSeries===target){ currentSeries=null; serieInfo.style.display="none"; document.body.style.backgroundImage=""; }
  else{ currentSeries=target; document.querySelectorAll("#seriesTabs button").forEach(b=>b.classList.remove("active")); btn.classList.add("active"); showSeasons(target,btn); }
  updateUIOnTabToggle();
});

backButton.addEventListener("click", ()=>{ currentSeries=null; serieInfo.style.display="none"; document.body.style.backgroundImage=""; updateUIOnTabToggle(); });

// ---------------- Filtros de busca + categoria
function applyFilters() {
  const q = (seriesSearch.value || "").toLowerCase().trim();
  const cat = categoryFilter.value;

  const keys = Object.keys(seriesData).filter(key => {
    const s = seriesData[key];

    // filtro de texto (nome da s√©rie)
    if (q && !s.name.toLowerCase().includes(q)) return false;

    // filtro de categoria
    if (cat && !(s.categories || []).some(c => c.toLowerCase() === cat.toLowerCase()))
      return false;

    return true;
  });

  buildTabs(keys);
}

seriesSearch.addEventListener("input", applyFilters);
categoryFilter.addEventListener("change", applyFilters);
// ---------------- Player
document.addEventListener("click", (e) => {
  const epItem = e.target.closest(".open-player");
  if (!epItem) return;

  // Encontra todos os epis√≥dios da mesma temporada
  const seasonContainer = epItem.closest(".accordion-collapse"); 
  const seasonEps = Array.from(seasonContainer.querySelectorAll(".open-player"));

  episodeQueue = seasonEps.map(b => ({ src: b.dataset.vid, title: b.dataset.title }));
  currentEpisodeIndex = seasonEps.indexOf(epItem);
  playEpisode(currentEpisodeIndex);
});

function playEpisode(index){
  if(index<0 || index>=episodeQueue.length) return;
  currentEpisodeIndex=index;
  const videoData = episodeQueue[currentEpisodeIndex];
  modalTitle.textContent = videoData.title;

  if(currentHls){ currentHls.destroy(); currentHls=null; }
  modalVideo.pause(); modalVideo.src="";

  if(Hls.isSupported() && videoData.src.endsWith(".m3u8")){
    currentHls = new Hls();
    currentHls.loadSource(videoData.src);
    currentHls.attachMedia(modalVideo);
    currentHls.on(Hls.Events.MANIFEST_PARSED, ()=>modalVideo.play());
  } else { modalVideo.src=videoData.src; modalVideo.play(); }

  new bootstrap.Modal(document.getElementById("playerModal")).show();
}

// ---------------- Controle de epis√≥dios
prevEpisodeBtn.addEventListener("click", ()=>{ if(currentEpisodeIndex>0) playEpisode(currentEpisodeIndex-1); });
nextEpisodeBtn.addEventListener("click", ()=>{ if(currentEpisodeIndex<episodeQueue.length-1) playEpisode(currentEpisodeIndex+1); });

// ---------------- Autoplay pr√≥ximo epis√≥dio
modalVideo.addEventListener("ended", ()=>{ if(currentEpisodeIndex<episodeQueue.length-1) playEpisode(currentEpisodeIndex+1); });

// ---------------- Limpeza ao fechar modal
document.getElementById("playerModal").addEventListener("hidden.bs.modal", ()=>{
  modalVideo.pause(); modalVideo.removeAttribute("src"); modalVideo.load();
  if(currentHls){ currentHls.destroy(); currentHls=null; }
  episodeQueue=[]; currentEpisodeIndex=0;
  document.body.classList.remove("modal-open");
  document.querySelectorAll(".modal-backdrop").forEach(el=>el.remove());
});

// ---------------- Barra de Rolagem ativa quando fecha modal
const playerModal = document.getElementById('playerModal');

playerModal.addEventListener('hidden.bs.modal', () => {
  document.body.style.overflowY = 'auto';
  document.documentElement.style.overflowY = 'auto';
});

// --- Web Video Cast ---
castButton.addEventListener("click", (e) => {
  e.preventDefault();

  if (!episodeQueue.length) {
    alert("Nenhum v√≠deo carregado.");
    return;
  }

  const title = modalTitle.textContent || "JC TV STREAMING";
  const realUrl = episodeQueue[currentEpisodeIndex].src;

  // Mant√©m o https://
  const intentLink = `intent://${realUrl.replace(/^https?:\/\//, '')}#Intent;scheme=https;package=com.instantbits.cast.webvideo;S.title=${encodeURIComponent(title)};end`;

  // Redireciona para o app
  window.location.href = intentLink;
});

// ---------------- Inicializa√ß√£o
populateCategories(); buildTabs(); updateUIOnTabToggle();
</script>
</body>
</html>
